# 学习笔记

## 14.1 文档结构

* 打开网页时，浏览器会获取页面的HTML文本并对其进行解析。浏览器构建文档结构的模型，并用此模型在屏幕上绘制页面。这种文档的表示是JavaScript程序在其沙盒中可用的工具之一，它是一种可以读取、修改的实时的数据结构
* 可以将HTML文档想象为嵌套的框，浏览器用于表示文档的数据结构遵循这种形状。每个框，都有一个对象，我们可以与之交互，以找出它代表什么HTML标签以及它包含哪些框和文本。这种表示称为文档对象模型（DOM）
* 全局绑定document使我们可以访问这些对象。其documentElement属性引用表示` <html> `标签的对象。由于每个HTML文档都有标头和正文，因此它还具有head和body属性，用来指向这些元素
* 元素、标签、属性的概念区分：
  * 元素由一个开始的标签和结束的标签组bai成，用来包含某些内容； 这里有一个值得注意的例外，即` <br/> `本身既是开始标签也是结束标签，但不包含任何内容，所以这只是个标签
  * 元素：HTML网页实际上就是由许许多多各种各样的HTML元素构成的文本文件，并且任何网页浏览器都可以直接运行HTML文件。所以可以这样说，HTML元素就是构成HTML文件的基本对象，HTML元素可以说是一个统称而已。HTML元素就是通过使用HTML标签进行定义的
  * 标签：标签就是` <head> `、` <body> `、` <table> `等被尖括号“<”和“>”包起来的对象，绝大部分的标签都是成对出现的，如` <table></talbe> `、` <form></form> `。当然还有少部分不是成对出现的，如` <br> `、` <hr> `等。标签就是用来标记HTML元素的。位于起始标签和结束标签之间的文本就是HTML元素的内容
  * 属性：为HTML元素提供各种附加信息的就是HTML属性，它总是以"属性名=属性值"这种名值对的形式出现，而且属性总是在HTML元素的开始标签中进行定义

## 14.2 树

* 当数据结构具有分支结构时，我们将其称为树
* 树没有回路（节点不可能直接或间接地包含自身），并且具有单个定义良好的根。对于DOM，document.documentElement被用作根
* 在计算机科学中出现了很多树形结构，因为树中比起在平面数组中通常可以更有效地查找或插入元素
* 每个DOM节点对象都有一个nodeType属性，此属性包含标识节点类型的代码（编号）：
  * 元素代码为1，定义为常量属性Node.ELEMENT_NODE
  * 文本节点代码为3，定义为常量属性Node.TEXT_NODE
  * 注释代码为8，定义常量属性Node.COMMENT_NODE

## 14.3 标准

* DOM不是针对JavaScript而设计的，它试图成为一个对语言中立的接口

## 14.4 通过树结构

* DOM节点包含与附近其他节点的大量链接
  * 每个节点都有一个parentNode属性，此属性指向它所属的节点（如果有）
  * 每个元素节点（节点类型1）都有一个childNodes属性，此属性指向一个包含其子节点的类数组对象
  * firstChild和lastChild属性指向第一个和最后一个子元素。对于没有子节点的节点，这两个属性具有null值
  * previousSibling和nextSibling指向相邻节点，这些节点是在节点本身之前或之后立即出现的具有相同父节点的节点。对于第一个子节点，previousSibling为null，对于最后一个子节点，nextSibling为null
  * children属性，类似于childNode，但只包含元素（类型1）子节点，而不包含其他类型的子节点
* 处理这样的嵌套数据结构时，递归函数通常很有用

## 14.5 寻找元素

* 所有元素节点都有一个getElementByTagName方法，此方法收集该节点的子节点（直接或间接子节点）中具有给定标签名称的所有元素，并将它们作为类似数组的对象返回
* 要查找特定的单个节点，可以为其指定id属性并使用document.getElementById来查找
* getElementByClassName搜索元素节点内容，并获取在其class属性中具有给定字符串的所有元素

## 14.6 更改文档

* 几乎所有关于DOM数据结构的内容都可以更改
* 节点remove方法，可以将它们从当前父节点中移除
* appendChild，将新节点放在子节点列表的末尾
* insertBefore，将把第一个参数给出的节点插到第二个参数给出的节点之前
* replaceChild，将子节点替换为另一个子节点，两个参数：新节点、要替换的节点。被替换的节点必须是调用此方法的元素的子节点

## 14.7 创建节点

* 使用document.createTextNode方法创建文本节点
* 要创建元素节点，使用document.createElement方法。此方法采用标签名称并返回给定类型的新空节点

## 14.8 属性

* 某些元素属性可以通过元素DOM对象上的同名属性访问
* HTML允许你在节点上设置所需的任何属性，但是如果建立自己的属性名，此类属性不会作为元素节点上的属性出现。你必须使用getAttribute和setAttribute方法来处理它们。建议在此类自己设置的属性名称前加上` data- `，以确保它们不与任何其他属性冲突

## 14.9 布局

* 块（block）元素，占据文档的整个宽度，并在单独的行上呈现
* 行内（inline）元素，与其周围文本在同一行上呈现
* 可以从JavaScript访问元素的大小和位置。offsetWidth和offsetHeight属性为你提供元素占用空间（以像素为单位）
* 像素是浏览器中的基本测量单位，现代显示器上浏览器像素可以跨越多个显示点
* clientWidth和clientHeight提供元素内部空间大小（忽略边框宽度）
* getBoundingClientRect返回一个包含top、bottom、left、right属性的对象，找到元素在屏幕上精确位置的方法。如果希望它们相对于整个文档，则必须添加当前滚动位置，可以在pageXOffset、pageYOffset绑定中找到该位置
* 为了提高速度，浏览器引擎不会在每次更改文档时立即重新对文档布局，而是等待尽可能长的时间。当更改文档的JavaScript程序完成运行时，浏览器必须对新布局进行计算，以将更改的文档绘制到屏幕上
* 在读取DOM布局信息和更改DOM之间反复交替的程序会强迫进行大量的布局计算，因此将非常缓慢地运行

## 14.10 样式

* style属性可能包含一个或多个声明，这些声明是属性（如color），后跟冒号和值。如果有多个声明，则必须用分号分隔
* JavaScript代码可以通过元素的style属性直接操作元素的样式。此属性包含一个对象，此对象具有所有可能的样式属性的属性（这些属性的值是字符串）
* 有些样式属性名称包含连接符，所以这些属性的样式对象中的属性名称会删除连接符，并且后面的字母大写。例如：` style["font-family"] ` 变成` style.fontFamily `

## 14.11 叠层样式

* HTML的样式系统称为CSS，表示层叠样式表（Cascading Style Sheets）。样式表是一组用于设置文档中元素样式的规则，可以在` <style></style> `标签内给出
* 标签的默认样式会被层叠样式表中的规则覆盖
* 可以在CSS规则中：
  * 指定标签名称
  * 规则` .abc `适用于其class属性中包含"abc"的所有元素
  * 规则` #xyz `适用于id属性为"xyz"的元素（在文档中应该是唯一的）
* 规则的具体性衡量它是如何精确地描述匹配元素，由它所需的元素的数量和种类（标签、类或ID）决定。例如：p.a的规则比针对p或仅针对.a的规则更具体，因此针对p.a的规则优先于后二者
* 表示法` p > a{...} `将给定样式应用于所有` <a> `标签，它是` <p> `标签的直接子项。` p a{...} `适用于` <p> `标签内部的所有` <a> `标签，无论后者是前者的直接还是间接子项
* 表示法中间的空格很重要，没有空格代表在一个元素中同时满足的“与”关系，有空格指的是层级关系，逗号隔开的是“或”关系

## 14.12 查询选择器

* querySelectAll方法（在document对象和元素节点上定义）采用选择器字符串，并返回包含它匹配的所有元素的NodeList
* querySelect方法（没有All部分），仅返回第一个匹配元素，或者在没有元素匹配时返回null

## 14.13 定位和动画

* position样式属性以强大的方式影响布局：
  * 默认情况下，它具有static值，意味着此元素位于文档中正常位置。
  * 当它设置为relative时，元素仍占用文档中的空间，但是可以使用top、left样式属性将它相对于正常位置移动。
  * 当position设置为absolute时，元素将从普通文档流中移除，它不再占用空间并且可能与其他元素重叠
  * 此外，它的top、left属性可以用于相对于其position属性不是static的最近的封闭元素的左上角绝对定位，或者如果不存在这样的封闭元素，则相对于文档定位
* Math.cos、Math.sin可用于计算原点为(0, 0)、半径为1的圆周上的点：
  * 这两个函数都将它们的参数解释为这个圆上的位置，
  * 零表示圆最右侧的点，顺时针方向运动到2π将绕过整个圆周
  * Math.cos告诉你与给定位置相对应点的x坐标（注意：顺时针运动得出的值正负直接使用，因为在相对坐标、屏幕显示坐标系统下的值，与数轴表示的坐标的正负数表达是不同的。例如数轴表示的十字坐标右下角象限中x是正、y是负，但屏幕显示坐标表达中，x和y都是正数）
  * Math.sin告诉你与给定位置相对应点的y坐标
